document.addEventListener("DOMContentLoaded",()=>{function e(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB","TB"][t]}function t(e){if(!e)return"";let t=new Date(e);if(isNaN(t))return"";let a=t.getDate(),l=t.getMonth()+1,i=t.getFullYear(),n=t.getHours().toString().padStart(2,"0"),r=t.getMinutes().toString().padStart(2,"0");return`${a}/${l}/${i} ${n}:${r}`}function a(e,t){try{return new URL(e,t).href}catch{return e}}function l(e,t){let a=e;for(let l of t)if(!(a=Array.from(a.children).find(e=>"folder"===e.tagName&&e.getAttribute("name")===l)))break;return a}function i(e){e.querySelectorAll(".selected").forEach(e=>e.classList.remove("selected"))}function n(e,t=!1){if(t)return"File folder";let a=e.includes(".")?e.split(".").pop().toLowerCase():"";return({ttf:"TrueType font",otf:"OpenType font",woff:"Web Open Font",woff2:"Web Open Font 2",txt:"Text Document",md:"Markdown Source File",svg:"SVG Image",png:"PNG Image",jpg:"JPEG Image",jpeg:"JPEG Image",gif:"GIF Image",webp:"WebP Image",ico:"Icon",ogg:"OGG Audio",mp3:"MP3 Audio",zip:"ZIP Archive",xml:"XML File",json:"JSON File",js:"JavaScript File",css:"CSS File",html:"HTML File",pdf:"PDF Document",csv:"CSV File",exe:"Executable",dll:"Dynamic Link Library",bat:"Batch File",sh:"Shell Script",mp4:"MP4 Video",webm:"WebM Video",mov:"QuickTime Video",avi:"AVI Video",m4a:"M4A Audio",wav:"WAV Audio",flac:"FLAC Audio"})[a]||(a?a.toUpperCase()+" File":"File")}function r(e,t=!1){if(t)return"fa-solid fa-folder";let a=e.includes(".")?e.split(".").pop().toLowerCase():"";return({ttf:"fa-solid fa-font",otf:"fa-solid fa-font",woff:"fa-solid fa-font",woff2:"fa-solid fa-font",txt:"fa-regular fa-file-lines",md:"fa-regular fa-file-lines",svg:"fa-regular fa-image",png:"fa-regular fa-image",jpg:"fa-regular fa-image",jpeg:"fa-regular fa-image",gif:"fa-regular fa-image",webp:"fa-regular fa-image",ogg:"fa-regular fa-file-audio",mp3:"fa-regular fa-file-audio",wav:"fa-regular fa-file-audio",flac:"fa-regular fa-file-audio",m4a:"fa-regular fa-file-audio",zip:"fa-regular fa-file-zipper",xml:"fa-regular fa-file-code",json:"fa-regular fa-file-code",js:"fa-brands fa-js",css:"fa-brands fa-css3-alt",html:"fa-brands fa-html5",pdf:"fa-regular fa-file-pdf",csv:"fa-regular fa-file-csv",exe:"fa-regular fa-file",dll:"fa-regular fa-file",bat:"fa-regular fa-file-code",sh:"fa-regular fa-file-code",mp4:"fa-regular fa-file-video",webm:"fa-regular fa-file-video",mov:"fa-regular fa-file-video",avi:"fa-regular fa-file-video"})[a]||"fa-regular fa-file"}function s(e,t,a,l,i){Array.from(e.children).filter(e=>"folder"===e.tagName).forEach(e=>{let n=e.getAttribute("name");n.toLowerCase().includes(a)&&l.push({type:"folder",name:n,pathArr:[...t],node:e}),s(e,[...t,n],a,l,i)}),Array.from(e.children).filter(e=>"file"===e.tagName).forEach(e=>{let n=e.getAttribute("name"),r=e.getAttribute("size"),s=r?parseInt(r,10):0;(!i.has(n)||r&&0!==s)&&n.toLowerCase().includes(a)&&l.push({type:"file",name:n,pathArr:[...t],node:e})})}function d(e,t,a,l){Array.from(e.children).filter(e=>"folder"===e.tagName).forEach(e=>{let i=e.getAttribute("name"),n=[...t,i],r="/"+n.join("/");a.push({type:"folder",name:i,pathArr:n,fullPath:r,node:e}),d(e,n,a,l)}),Array.from(e.children).filter(e=>"file"===e.tagName).forEach(e=>{let i=e.getAttribute("name"),n=e.getAttribute("size"),r=n?parseInt(n,10):0;if(l.has(i)&&(!n||0===r))return;let s=[...t,i],d="/"+s.join("/");a.push({type:"file",name:i,pathArr:s,fullPath:d,node:e})})}function o(e){let t={navbar:!0,type:!0,modified:!0,size:!0,search:!0,directorybar:!0,icons:!0,topbar:!0,labels:!0,"labels.name":"Name","labels.modified":"Date Modified","labels.type":"Type","labels.size":"Size"};return e&&e.split(";").forEach(e=>{let[a,l]=e.split(":");a&&(a=a.trim().toLowerCase(),l=(l||"").trim(),a.startsWith("labels.")?(t[a]=l||t[a],"labels"===a&&(t.labels="false"!==l)):a in t&&(t[a]=""===l||"true"===l.toLowerCase()))}),t}function f(e){return"dfmfont_"+e.replace(/[^a-zA-Z0-9]/g,"_")+"_"+Math.random().toString(36).slice(2,8)}function c(e,t,a){if(document.getElementById("dfm-font-"+e))return;let l="truetype";"otf"===a?l="opentype":"woff"===a?l="woff":"woff2"===a&&(l="woff2");let i=document.createElement("style");i.id="dfm-font-"+e,i.textContent=`
        @font-face {
          font-family: '${e}';
          src: url('${t}') format('${l}');
          font-display: swap;
        }
      `,document.head.appendChild(i)}document.querySelectorAll("[root-src]").forEach(p=>{let m=o(p.getAttribute("dfm-config")),u=p.getAttribute("dfm-baseurl")||null,h=null,g=null,b=[],v=[],E=-1,y="",w=[],C=-1,L=[],$=-1,A=new Set,N=null,x=null,_="list";p.innerHTML="",p.classList.add("dfm-explorer-container");let k;m.topbar&&((k=document.createElement("div")).className="dfm-explorer-bar",m.navbar&&(k.innerHTML+=`<button class="dfm-back-btn" title="Back"><i class="fa-solid fa-arrow-left"></i></button>
               <button class="dfm-forward-btn" title="Forward"><i class="fa-solid fa-arrow-right"></i></button>
               <button class="dfm-refresh-btn" title="Refresh"><i class="fa-solid fa-rotate-right"></i></button>`),m.directorybar&&(k.innerHTML+=`<div class="dfm-bar-path">
                 <input type="text" class="dfm-path-input" value="/" title="Path">
                 <ul class="dfm-explorer-path-dropdown"></ul>
               </div>`),m.search&&(k.innerHTML+=`<div class="dfm-bar-search">
                 <input type="text" class="dfm-search-input" placeholder="Search">
                 <ul class="dfm-explorer-search-dropdown"></ul>
               </div>`),p.appendChild(k));let M=document.createElement("div");M.className="dfm-explorer-mainflex";let T=document.createElement("div");T.className="dfm-explorer-nav";let S=document.createElement("div");S.className="dfm-explorer-nav-resizer";let H=document.createElement("div");H.className="dfm-explorer-list";let z=document.createElement("div");z.className="dfm-explorer-details-resizer";let P=document.createElement("div");P.className="dfm-explorer-details";let F=document.createElement("div");F.className="dfm-explorer-statusbar",F.innerHTML=`
        <span class="dfm-statusbar-left"></span>
        <span class="dfm-statusbar-right">
          <button class="dfm-statusbar-btn dfm-view-list selected" title="List view">
            <i class="fa-solid fa-bars"></i>
          </button>
          <button class="dfm-statusbar-btn dfm-view-grid" title="Grid view">
            <i class="fa-regular fa-square"></i>
          </button>
        </span>
      `,M.appendChild(T),M.appendChild(S),M.appendChild(H),M.appendChild(z),M.appendChild(P),p.appendChild(M),p.appendChild(F),function e(){let t=!1,a=0,l=0;S.addEventListener("mousedown",function(e){t=!0,a=e.clientX,l=T.offsetWidth,document.body.style.cursor="col-resize",document.body.style.userSelect="none",e.preventDefault()}),window.addEventListener("mousemove",function e(i){if(!t)return;let n=Math.max(100,Math.min(500,l+(i.clientX-a)));T.style.width=n+"px",T.style.flex="0 0 "+n+"px"}),window.addEventListener("mouseup",function e(){t&&(t=!1,document.body.style.cursor="",document.body.style.userSelect="")})}(),function e(){let t=!1,a=0,l=0;z.addEventListener("mousedown",function(e){t=!0,a=e.clientX,l=P.offsetWidth,document.body.style.cursor="col-resize",document.body.style.userSelect="none",e.preventDefault()}),window.addEventListener("mousemove",function e(i){if(!t)return;let n=Math.max(120,Math.min(500,l+(a-i.clientX)));P.style.width=n+"px",P.style.flex="0 0 "+n+"px"}),window.addEventListener("mouseup",function e(){t&&(t=!1,document.body.style.cursor="",document.body.style.userSelect="")})}();let j=k?.querySelector(".dfm-back-btn"),D=k?.querySelector(".dfm-forward-btn"),q=k?.querySelector(".dfm-refresh-btn"),W=k?.querySelector(".dfm-path-input"),I=k?.querySelector(".dfm-explorer-path-dropdown"),B=k?.querySelector(".dfm-search-input"),G=k?.querySelector(".dfm-explorer-search-dropdown");function V(e,t=!0){b=[...e],t&&((v=v.slice(0,E+1)).push([...b]),E=v.length-1),N=null,x=null,et(),U()}function O(){E>0&&(b=[...v[--E]],N=null,x=null,et(),U())}function X(){E<v.length-1&&(b=[...v[++E]],N=null,x=null,et(),U())}function J(){g&&ei(g,!0,b)}function U(){W&&(W.value="/"+b.join("/")),j&&(j.disabled=E<=0),D&&(D.disabled=E>=v.length-1)}function R(e){let t=e.getAttribute("updated_at");if(!t)return 0;let a=new Date(t);return isNaN(a)?0:a.getTime()}function Z(){if(!h){T.innerHTML="<div class='dfm-navtree-nodata'>No data</div>";return}T.innerHTML="";let e=document.createElement("ul");e.className="dfm-navtree";let t=document.createElement("li"),a=document.createElement("span");a.innerHTML=m.icons?'<i class="fa-solid fa-folder-tree"></i> ':"";let l=document.createElement("span");l.className="dfm-navtree-folder",l.innerHTML="<b>Root</b>",0===b.length&&l.classList.add("selected"),l.onclick=()=>{V([]),Z()},t.appendChild(a),t.appendChild(l);let i=document.createElement("ul");(function e(t,a){let l=Array.from(t.children).filter(e=>"folder"===e.tagName).sort((e,t)=>e.getAttribute("name").toLowerCase().localeCompare(t.getAttribute("name").toLowerCase()));return l.map(t=>{let l=t.getAttribute("name"),i=[...a,l],n="/"+i.join("/"),r=document.createElement("li"),s=Array.from(t.children).some(e=>"folder"===e.tagName),d=A.has(n),o=document.createElement("span");o.className="dfm-navtree-toggle",o.innerHTML=s?d?"&#9660;":"&#9654;":"",s&&(o.onclick=e=>{e.stopPropagation(),d?A.delete(n):A.add(n),Z()});let f=document.createElement("span");if(f.className="dfm-navtree-folder",f.innerHTML=(m.icons?'<i class="fa-solid fa-folder"></i> ':"")+l,b.length===i.length&&b.every((e,t)=>e===i[t])&&f.classList.add("selected"),f.onclick=e=>{V(i),A.add(n),Z()},r.appendChild(o),r.appendChild(f),s&&d){let c=document.createElement("ul");e(t,i).forEach(e=>c.appendChild(e)),r.appendChild(c)}return r})})(h,[]).forEach(e=>i.appendChild(e)),t.appendChild(i),e.appendChild(t),T.appendChild(e)}function K(){if(P.innerHTML="",!N){P.innerHTML='<div class="dfm-details-nofile">No file selected</div>';return}let e=N,l=e.getAttribute("name"),i=n(l,!1),s=r(l,!1),d=e.getAttribute("updated_at"),o=x||"",p=l.includes(".")?l.split(".").pop().toLowerCase():"",m=e.getAttribute("path")?a(e.getAttribute("path"),u||g):null,h=document.createElement("div");h.className="dfm-details-preview";let b=null,v=[];if(["png","jpg","jpeg","gif","svg","webp","ico"].includes(p)&&m)(b=document.createElement("img")).src=m,b.alt=l,b.className="dfm-details-img",b.onload=function(){["png","jpg","jpeg","gif","webp"].includes(p)&&b.naturalWidth&&b.naturalHeight&&(v=[{label:"Dimensions",value:b.naturalWidth+" x "+b.naturalHeight},],C())};else if(["ttf","otf","woff","woff2"].includes(p)&&m){let E=f(l);c(E,m,p),(b=document.createElement("div")).className="dfm-details-font-preview",b.textContent="The quick brown fox jumps over the lazy dog",b.style.fontFamily=`'${E}', sans-serif`,b.style.fontSize="1.5em",b.style.padding="0.5em 0",b.style.overflowWrap="break-word"}else["mp4","webm","mov","avi"].includes(p)&&m?((b=document.createElement("video")).src=m,b.controls=!0,b.className="dfm-details-video"):["mp3","ogg","wav","flac","m4a"].includes(p)&&m?((b=document.createElement("audio")).src=m,b.controls=!0,b.className="dfm-details-audio"):((b=document.createElement("div")).innerHTML=`<i class="${s}"></i>`,b.className="dfm-details-icon");h.appendChild(b);let y=document.createElement("div");y.className="dfm-details-header",y.innerHTML=`<i class="${s}"></i> <span>${l}</span>`;let w=document.createElement("ul");function C(){w.innerHTML="",[{label:"Type",value:i},{label:"File location",value:o},{label:"Date modified",value:t(d)},...v||[],].forEach(e=>{let t=document.createElement("li");t.innerHTML=`<span class="dfm-details-label">${e.label}:</span> <span class="dfm-details-value">${e.value||""}</span>`,w.appendChild(t)})}w.className="dfm-details-list",C(),P.appendChild(h),P.appendChild(y),P.appendChild(w)}function Q(e){let t=F.querySelector(".dfm-statusbar-left");t&&(t.textContent=`${e} item${1===e?"":"s"}`)}let Y=F.querySelector(".dfm-view-list"),ee=F.querySelector(".dfm-view-grid");function et(s=null){H.innerHTML="";let d=0;if(!h){H.textContent="No data",Z(),K(),Q(0);return}let o=l(h,b)||h;if("list"===_){let p=document.createElement("ul");if(p.className="dfm-list-ul",m.labels){let v=document.createElement("li");v.className="header",v.appendChild(document.createElement("span")).textContent=m["labels.name"],m.modified&&(v.appendChild(document.createElement("span")).textContent=m["labels.modified"]),m.type&&(v.appendChild(document.createElement("span")).textContent=m["labels.type"]),m.size&&(v.appendChild(document.createElement("span")).textContent=m["labels.size"]),p.appendChild(v)}if(b.length>0){let E=document.createElement("li");E.className="folder up";let y=document.createElement("span");y.className="folder-name",y.innerHTML=m.icons?'<i class="fa-solid fa-folder"></i> ..':"..",y.onclick=e=>{i(p),E.classList.add("selected"),e.stopPropagation()},y.ondblclick=()=>V(b.slice(0,-1)),E.appendChild(y),m.modified&&E.appendChild(document.createElement("span")),m.type&&E.appendChild(document.createElement("span")),m.size&&E.appendChild(document.createElement("span")),p.appendChild(E)}let w=new Set(Array.from(o.children).filter(e=>"folder"===e.tagName).map(e=>e.getAttribute("name"))),C=Array.from(o.children).filter(e=>"folder"===e.tagName);C.sort((e,t)=>R(t)-R(e)),C.forEach(e=>{let a=document.createElement("li");a.className="folder";let l=document.createElement("span");if(l.className="folder-name",l.innerHTML=m.icons?`<i class="fa-solid fa-folder"></i> ${e.getAttribute("name")}`:e.getAttribute("name"),l.onclick=e=>{i(p),a.classList.add("selected"),N=null,x=null,K(),e.stopPropagation()},l.ondblclick=t=>{V([...b,e.getAttribute("name")]),t.stopPropagation()},s===e.getAttribute("name")&&a.classList.add("selected"),a.appendChild(l),m.modified){let r=document.createElement("span");r.className="file-date",r.textContent=t(e.getAttribute("updated_at")),a.appendChild(r)}if(m.type){let d=document.createElement("span");d.className="file-type",d.textContent=n(e.getAttribute("name"),!0),a.appendChild(d)}m.size&&a.appendChild(document.createElement("span")),p.appendChild(a)});let L=Array.from(o.children).filter(e=>"file"===e.tagName).filter(e=>{let t=e.getAttribute("name"),a=e.getAttribute("size"),l=a?parseInt(a):0;return!(w.has(t)&&(!a||0===l))});L.sort((e,t)=>R(t)-R(e)),L.forEach(l=>{let r=document.createElement("li");r.className="file";let d=document.createElement("span");if(d.className="file-name",d.innerHTML=m.icons?`<i class="fa-regular fa-file"></i> ${l.getAttribute("name")}`:l.getAttribute("name"),m.modified){let o=document.createElement("span");o.className="file-date",o.textContent=t(l.getAttribute("updated_at")),r.appendChild(o)}if(m.type){let f=document.createElement("span");f.className="file-type",f.textContent=n(l.getAttribute("name"),!1),r.appendChild(f)}if(m.size){let c=document.createElement("span");c.className="file-size",c.textContent=e(parseInt(l.getAttribute("size")||0)),r.appendChild(c)}d.onclick=e=>{i(p),r.classList.add("selected"),N=l,x="/"+[...b,l.getAttribute("name")].join("/"),K(),e.stopPropagation()},d.ondblclick=e=>{let t=l.getAttribute("path");if(t){let i=u||g;window.open(a(t,i),"_blank")}e.stopPropagation()},s===l.getAttribute("name")&&r.classList.add("selected"),r.insertBefore(d,r.firstChild),p.appendChild(r)}),d=C.length+L.length,H.appendChild(p)}else{let $=document.createElement("div");if($.className="dfm-grid",b.length>0){let A=document.createElement("div");A.className="dfm-grid-item folder up",A.innerHTML=`<div class="dfm-grid-icon"><i class="fa-solid fa-folder"></i></div>
              <div class="dfm-grid-title">..</div>`,A.onclick=()=>V(b.slice(0,-1)),$.appendChild(A)}let k=Array.from(o.children).filter(e=>"folder"===e.tagName);k.sort((e,t)=>R(t)-R(e)),k.forEach(e=>{let t=e.getAttribute("name"),a=document.createElement("div");a.className="dfm-grid-item folder",a.innerHTML=`<div class="dfm-grid-icon"><i class="fa-solid fa-folder"></i></div>
              <div class="dfm-grid-title">${t}</div>`,a.onclick=e=>{$.querySelectorAll(".selected").forEach(e=>e.classList.remove("selected")),a.classList.add("selected"),N=null,x=null,K(),e.stopPropagation()},a.ondblclick=e=>{V([...b,t]),e.stopPropagation()},$.appendChild(a)});let M=Array.from(o.children).filter(e=>"file"===e.tagName).filter(e=>{let t=e.getAttribute("name"),a=e.getAttribute("size"),l=a?parseInt(a):0;return!(k.some(e=>e.getAttribute("name")===t)&&(!a||0===l))});M.sort((e,t)=>R(t)-R(e)),M.forEach(e=>{let t=e.getAttribute("name"),l=t.includes(".")?t.split(".").pop().toLowerCase():"",i=e.getAttribute("path")?a(e.getAttribute("path"),u||g):null,n=r(t,!1),s=document.createElement("div");s.className="dfm-grid-item file";let d=null;if(["png","jpg","jpeg","gif","svg","webp"].includes(l)&&i)(d=document.createElement("img")).src=i,d.alt=t,d.className="dfm-grid-img";else if(["ttf","otf","woff","woff2"].includes(l)&&i){let o=f(t);c(o,i,l),(d=document.createElement("div")).className="dfm-grid-font-preview",d.textContent="ABC",d.style.fontFamily=`'${o}', sans-serif`,d.style.fontSize="2em",d.style.textAlign="center",d.style.padding="0.2em 0",d.style.overflowWrap="break-word"}else(d=document.createElement("div")).className="dfm-grid-icon",d.innerHTML=`<i class="${n}"></i>`;s.appendChild(d);let p=document.createElement("div");p.className="dfm-grid-title",p.textContent=t,s.appendChild(p),s.onclick=t=>{$.querySelectorAll(".selected").forEach(e=>e.classList.remove("selected")),s.classList.add("selected"),N=e,x="/"+[...b,e.getAttribute("name")].join("/"),K(),t.stopPropagation()},s.ondblclick=t=>{let l=e.getAttribute("path");if(l){let i=u||g;window.open(a(l,i),"_blank")}t.stopPropagation()},$.appendChild(s)}),d=k.length+M.length,H.appendChild($)}Z(),K(),Q(d)}function ea(e,t,a,l){if(e.innerHTML="",!t.length){e.classList.remove("open");return}t.forEach((t,i)=>{let n=document.createElement("li");n.tabIndex=0,n.className=i===a?"selected":"",n.innerHTML=`
              <span class="search-icon">
                ${m.icons?`<i class="fa-${"folder"===t.type?"solid fa-folder":"regular fa-file"}"></i>`:""}
              </span>
              <span class="search-name">${t["path"===l?"fullPath":"name"]}</span>
              ${"search"===l?`<span class="search-path">(${0===t.pathArr.length?"..":"../"+t.pathArr.join("/")})</span>`:""}
            `,n.onclick=a=>{"path"===l?("folder"===t.type?(V(t.pathArr),et()):(V(t.pathArr.slice(0,-1)),setTimeout(()=>et(t.name),10)),e.classList.remove("open"),W.value=t.fullPath):(V(t.pathArr),setTimeout(()=>et(t.name),10),e.classList.remove("open"),B.value="",y="")},n.onmousedown=e=>e.preventDefault(),e.appendChild(n)}),e.classList.add("open")}function el(e,t){e.classList.remove("open"),"search"===t?C=-1:$=-1}async function ei(e,t=!1,a=null){if(H.textContent="Loading...",T.innerHTML="",P.innerHTML="",!t&&g===e&&h){et(),U();return}try{let i=await fetch(e);if(!i.ok)throw Error("Fetch failed");let n=await i.text(),r=new DOMParser().parseFromString(n,"application/xml"),s=r.querySelector("root");if(!s)throw Error("No <root>");h=s,g=e;let d=a||b||[],o=l(h,d);for(;d.length&&!o;)d=d.slice(0,-1),o=l(h,d);b=d,v.length||(v=[d],E=0),N=null,x=null,et(),U()}catch(f){H.textContent="Error: "+f.message,T.innerHTML="",P.innerHTML="",Q(0)}}Y.onclick=()=>{"list"!==_&&(_="list",Y.classList.add("selected"),ee.classList.remove("selected"),et())},ee.onclick=()=>{"grid"!==_&&(_="grid",ee.classList.add("selected"),Y.classList.remove("selected"),et())},document.addEventListener("mousedown",e=>{k?.contains(e.target)||I.contains(e.target)||G.contains(e.target)||(G&&el(G,"search"),I&&el(I,"path"))}),j&&(j.onclick=O),D&&(D.onclick=X),q&&(q.onclick=J),W&&(W.addEventListener("input",()=>{if(!h)return;let e=W.value.trim();if(!e||"/"===e){el(I,"path");return}let t=new Set;(function e(a){Array.from(a.children).filter(e=>"folder"===e.tagName).forEach(a=>{t.add(a.getAttribute("name")),e(a)})})(h),d(h,[],L=[],t);let a=e.toLowerCase(),l=L.filter(e=>e.fullPath.toLowerCase().includes(a)).slice(0,50);ea(I,l,$,"path")}),W.addEventListener("focus",()=>W.dispatchEvent(new Event("input"))),W.addEventListener("keydown",e=>{if(I.classList.contains("open")){if("ArrowDown"===e.key)e.preventDefault(),$=Math.min($+1,L.length-1),ea(I,L.slice(0,50),$,"path");else if("ArrowUp"===e.key)e.preventDefault(),$=Math.max($-1,0),ea(I,L.slice(0,50),$,"path");else if("Enter"===e.key){if($>=0&&$<L.length){let t=L[$];"folder"===t.type?(V(t.pathArr),et()):(V(t.pathArr.slice(0,-1)),setTimeout(()=>et(t.name),10)),el(I,"path"),W.value=t.fullPath,e.preventDefault()}else{let a=W.value.trim();a||(a="/"),a.startsWith("/")||(a="/"+a),V(a.split("/").filter(Boolean)),el(I,"path")}}else"Escape"===e.key&&el(I,"path")}})),B&&(B.addEventListener("input",()=>{if(!(y=B.value.trim().toLowerCase())||!h){el(G,"search");return}let e=new Set;(function t(a){Array.from(a.children).filter(e=>"folder"===e.tagName).forEach(a=>{e.add(a.getAttribute("name")),t(a)})})(h),s(h,[],y,w=[],e),ea(G,w,C,"search")}),B.addEventListener("focus",()=>{w.length&&ea(G,w,C,"search")}),B.addEventListener("keydown",e=>{if(G.classList.contains("open")){if("ArrowDown"===e.key)e.preventDefault(),C=Math.min(C+1,w.length-1),ea(G,w,C,"search");else if("ArrowUp"===e.key)e.preventDefault(),ea(G,w,C=Math.max(C-1,0),"search");else if("Enter"===e.key){if(C>=0&&C<w.length){let t=w[C];V(t.pathArr),setTimeout(()=>et(t.name),10),el(G,"search"),B.value="",y=""}}else"Escape"===e.key&&el(G,"search")}}));let en=p.getAttribute("root-src");en&&ei(en)})});
